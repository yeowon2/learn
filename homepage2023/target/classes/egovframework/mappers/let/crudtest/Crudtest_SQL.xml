<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="egovframework.let.crudtest.service.impl.CrudtestMapper">

	<resultMap id="crudtest" type="egovframework.let.crudtest.service.CrudtestVO">
		<result property="testId" column="TEST_ID"/>
		<result property="sj" column="SJ"/>
		<result property="cn" column="CN"/>
		<result property="userNm" column="USER_NM"/>
		<result property="frstRegistPnttm" column="FRST_REGIST_PNTTM" />
		<result property="frstRegisterId" column="FRST_REGISTER_ID" />
		<result property="lastUpdtPnttm" column="LAST_UPDT_PNTTM" />
		<result property="lastUpdusrId" column="LAST_UPDUSR_ID" />
	</resultMap>
	
	<select id="selectCrudtestList" resultType="egovMap">
		SELECT  
			TEST_ID 
			, SJ 
			, USER_NM 
			, DATE_FORMAT(FRST_REGIST_PNTTM, '%Y-%m-%d') AS FRST_REGIST_PNTTM
			, DATE_FORMAT(LAST_UPDT_PNTTM, '%Y-%m-%d') AS LAST_UPDT_PNTTM  
		FROM LETCRUDTEST
		ORDER BY TEST_ID DESC
		LIMIT #{recordCountPerPage} OFFSET #{firstIndex}
	</select>
	
	<select id="selectCrudtestListCnt" resultType="java.lang.Integer">
		SELECT  
			COUNT(*) CNT
		FROM LETCRUDTEST
	</select>

	<select id="selectCrudtest" resultMap="crudtest">
		SELECT 
		TEST_ID 
		, SJ 
		, CN 
		, USER_NM 
		, FRST_REGIST_PNTTM 
	FROM LETCRUDTEST
	WHERE TEST_ID = #{testId}
	</select>
	
	<insert id="insertCrudtest" parameterType="egovframework.let.crudtest.service.CrudtestVO">
		INSERT INTO LETCRUDTEST(
			TEST_ID 
			, SJ 
			, CN 
			, USER_NM 
			, FRST_REGIST_PNTTM
			, LAST_UPDT_PNTTM
		) VALUES (
			#{testId}
			, #{sj}
			, #{cn}
			, #{userNm}
			, NOW()
			, NOW()
		)
	</insert>
	
	<update id="updateCrudtest" parameterType="egovframework.let.crudtest.service.CrudtestVO">
		UPDATE LETCRUDTEST SET 
			SJ = #{sj}
			, CN = #{cn}
			, USER_NM = #{userNm}
			, LAST_UPDT_PNTTM = NOW()
		WHERE TEST_ID = #{testId}
	</update>
	
	<delete id="deleteCrudtest" parameterType="egovframework.let.crudtest.service.CrudtestVO">
		DELETE FROM LETCRUDTEST 
		WHERE TEST_ID = #{testId}
	</delete>
	
</mapper>